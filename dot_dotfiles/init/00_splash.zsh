LUGIA_ART=(
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢿⣿⣦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣿⣿⣿⣷⣄⠀⠀⠀⢀⢿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡀⠀⠀⠀⣿⣿⣿⣿⣿⣷⣄⠀⡜⢸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⢯⡉⠛⠲⠿⣿⣿⣿⣿⣿⣿⣿⡀⢸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠳⣄⠀⠀⠀⠙⠻⣿⣿⣿⣿⣷⡼⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣽⣦⡀⠀⢰⡆⠈⠙⢿⢿⣿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⣿⣿⣿⣦⣤⣭⣬⣥⣀⣾⣿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⠀⠀⠀⢠⣿⣿⣿⣿⣿⣆⢮⣫⣦⠈⠉⠛⠁⢀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣷⣄⠀⠀⢸⣿⣿⣿⣿⣯⠛⢮⣻⡽⠀⠀⣠⣾⣿⠀⠀⠀⠀⠀⠀⢠⣆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠻⣿⣿⣿⣦⢸⣿⣿⣿⣿⣿⠀⠀⣨⣭⣥⣾⡿⠟⠉⠀⠀⠀⠀⠀⠀⢸⣿⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣄⡈⠙⠿⡿⢸⣿⣿⣿⣿⣿⣇⣤⣈⠛⠛⠉⢀⣤⣾⣿⠀⠀⠀⠀⠀⠘⣿⣿⢆⡇⣀⣠⣤⡄⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣿⣿⠗⣠⣾⡞⣿⣿⣿⣿⣿⣿⣿⣿⣿⣶⣌⠻⠿⠋⣁⣤⠀⠀⠀⠀⠀⢻⠟⣾⠇⣿⡿⠋⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾⣿⣿⣷⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⣝⠻⠛⠀⠀⠀⠀⠀⢀⣾⣿⠘⠋⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⣟⢿⣿⣿⣿⣿⣮⣁⠀⠀⠀⣠⣿⣿⡏⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾⣿⣿⣿⣿⠋⢸⣿⢿⣿⣿⣿⣿⣿⠟⠁⠀⠀⠀⠈⠻⣿⣿⣿⣿⣷⣄⡺⣿⣿⡿⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾⣿⣿⣿⣿⡿⠁⠀⠸⠇⠀⠈⠛⢿⡿⠋⠀⠀⠀⠀⠀⠀⠀⠘⢿⣿⣿⣿⣿⣿⣦⡙⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⠀⢀⣾⣿⣿⣿⣿⣿⡟⠁⠀⠀⣠⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣷⡈⢻⣿⣿⣿⣿⣿⣿⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⠀⠀⣴⣿⣿⣿⣿⣿⣿⡿⠀⠀⠀⠀⣿⣆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣾⣿⣿⠀⢻⣿⣿⣿⣿⣿⣿⣿⣷⡄⠀⠀⠀⠀⠀⠀"
"⠀⠀⠀⠀⢀⣾⣿⣿⣿⣿⣿⣿⣿⠃⠀⠀⠀⠀⢹⣿⣦⡀⠀⠀⠀⠀⠀⠀⠀⢀⣤⣿⡿⢟⣡⢻⡌⣿⣿⣿⣿⣿⣿⣿⣿⣿⣆⠀⠀⠀⠀⠀"
"⠀⠀⠀⢀⣿⣿⣿⣿⣿⣿⣿⣿⡿⠀⠀⠀⠀⠀⠀⠙⠛⠿⣿⣶⡆⠲⢶⣶⣿⣿⣶⣶⢺⣿⣿⣧⠁⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⠀⠀⠀⠀"
"⠀⠀⠀⣾⣿⣿⣿⣿⣿⣿⣿⣿⣇⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⣿⡇⠀⠀⠀⠈⠉⠉⠀⠘⢿⣟⠟⠀⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣆⠀⠀⠀"
"⠀⠀⣸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡀⠀⠀⠀⠀⠀⠀⠀⠀⠻⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡄⠀⠀"
"⠀⠀⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⢢⠀"
"⠀⡄⣿⢻⣿⣿⡟⣿⣿⣿⣿⠻⣿⣿⣿⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⣿⣿⣿⠇⣿⣿⣿⣿⡇⣿⣿⣿⡏⣿⣼⡆"
"⢸⡇⣿⢸⣿⣿⣿⠸⣿⣿⣿⡇⠘⢿⣿⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠛⠿⢿⠋⠀⢸⣿⣿⣿⡇⢿⣿⣿⡇⣿⡇⠀"
"⠈⠃⣿⡼⣿⣿⣿⠀⢿⣿⣿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣿⣿⣿⠃⢸⣿⣿⠇⠿⠁⠀"
"⠀⠀⠹⠇⢿⣿⣿⡆⠘⣿⣿⣿⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⣿⣿⠟⠀⠸⠿⠛⠀⠀⠀⠀"
"⠀⠀⠀⠀⠈⠛⠋⠁⠀⠉⠉⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
)
###############################################################################
#  1. Random flavour line that appears in the dialogue box at the bottom      #
###############################################################################
LUGIA_FLAVOR_LINES=(
  "The winds whisper... Lugia watches silently..."
  "The summit is silent... Only champions ascend here."
  "The waves grow restless... A presence stirs below..."
  "A storm brews outside Mt. Silver..."
  "The stars shimmer faintly... ancient powers await."
  "You're now entering Mt. Silver... A mysterious presence fills the air..."
)
FLAVOR_LINE="${LUGIA_FLAVOR_LINES[RANDOM % ${#LUGIA_FLAVOR_LINES[@]}]}"

############################
#  Trainer-panel content   #
############################
# Gather trainer panel data
TRAINER_NAME=$(whoami)
TRAINER_LOCATION=$(hostname -f 2>/dev/null || cat /etc/hostname)
TRAINER_WEATHER=$(curl -s 'wttr.in/aus+tx?format=%C%20%t')
TRAINER_PLAYTIME=$(uptime -p | sed 's/^up //' || cat /proc/uptime | awk '{print $1}' | xargs -I{} awk -v var={} 'BEGIN {printf "%d weeks, %d days, %d hours, %d minutes\n", var/604800, (var%604800)/86400, (var%86400)/3600, (var%3600)/60}')
TRAINER_WHITE_OUT="$(awk '{print int($1/86400)}' /proc/uptime)d since party fainted"

CAMP_PARTY_HP=$(free -m | awk '/^Mem:/ {printf "%d%%", 100-int($3*100/$2)}')
CAMP_BOX_SPACE=$(df -h /home | awk 'NR==2{print $3 " / " $2}')
CAMP_MONEY="$(awk '/^( *eth0:| *wlan0:)/ { gsub(":", ""); t += $2 + $10 } END { printf "%.0f\n", t / 1000 }' /proc/net/dev | numfmt --grouping)₽"

COMM_GTS=$(curl ifconfig.io/host)
COMM_LINK_LAN=$(hostname -i | awk '{print $1}')
COMM_TRAINERS="$(ss -tan | awk 'NR>1{c++} END{print c}') nearby"

POKE_SEEN=$(
  if command -v pacman >/dev/null 2>&1; then pacman -Qq | wc -l
  elif command -v dpkg >/dev/null 2>&1; then dpkg -l | awk '/^ii/{c++} END{print c}'
  elif command -v rpm >/dev/null 2>&1; then rpm -qa | wc -l
  else echo "N/A"
  fi | tr -d '\n'
)
POKE_CAUGHT=$(ps ax --no-header | wc -l)
POKE_BADGES=16

TRAINER_INFO=(
  "=== TRAINER ==="
  " ↳ Name:        $TRAINER_NAME"
  " ↳ Location:    $TRAINER_LOCATION"
  " ↳ Weather:     $TRAINER_WEATHER"
  " ↳ Playtime:    $TRAINER_PLAYTIME"
  " ↳ White-out:   $TRAINER_WHITE_OUT"

  "=== CAMP GEAR ==="
  " ↳ Party HP:    $CAMP_PARTY_HP"
  " ↳ Box Space:   $CAMP_BOX_SPACE"
  " ↳ ₽ Money:     $CAMP_MONEY"

  "=== COMM LINK ==="
  " ↳ GTS:         $COMM_GTS"
  " ↳ Link (LAN):  $COMM_LINK_LAN"
  " ↳ Trainers:    $COMM_TRAINERS"

  "=== POKÉDEX ==="
  " ↳ Seen:        $POKE_SEEN"
  " ↳ Caught:      $POKE_CAUGHT"
  " ↳ Badges:      $POKE_BADGES"
)

###############################################################################
#  Build the boxed trainer panel                                              #
###############################################################################
TBOX_W=57
TRAINER_INFO_BOX=( "╔$(printf '═%.0s' $(seq 1 $((TBOX_W-2))))╗" )
for line in "${TRAINER_INFO[@]}"; do
  printf -v row "║ %-*s ║" $((TBOX_W-4)) "$line"
  TRAINER_INFO_BOX+=( "$row" )
done
TRAINER_INFO_BOX+=( "╚$(printf '═%.0s' $(seq 1 $((TBOX_W-2))))╝" )

TBOX_START=4                                  # Lugia line where panel begins

###############################################################################
#  1)  Print Lugia art first                                                  #
###############################################################################
tput clear
for art_line in "${LUGIA_ART[@]}"; do
  printf "${BOX_COLOR}%-60s${RESET_COLOR}\n" "$art_line"
done

###############################################################################
#  2)  Over-print the trainer panel at column 62                              #
#      (drawn *after* Lugia so its bottom border is never overwritten)        #
###############################################################################
# Move cursor up to the panel’s first row
tput cuu $(( ${#LUGIA_ART[@]} - TBOX_START ))

# Draw the boxed rows
for panel_row in "${TRAINER_INFO_BOX[@]}"; do
  printf "\033[62G${BOX_COLOR}%s${RESET_COLOR}\n" "$panel_row"
done

# Move cursor back down to the end of Lugia art
tput cud $(( ${#LUGIA_ART[@]} - TBOX_START - ${#TRAINER_INFO_BOX[@]} ))

###############################################################################
#  3)  Dialogue-style flavour textbox                                         #
###############################################################################
DBOX_W=56
# choose random flavour (defined earlier)
WRAPPED_FLAVOR_LINE=$(echo "$FLAVOR_LINE" | fmt -w $((DBOX_W-4)))

# draw box
printf "${BOX_COLOR}╔"; printf '═%.0s' $(seq 1 $((DBOX_W-2))); printf "╗\n"
while IFS= read -r L; do
  printf "${BOX_COLOR}║ %-*s ║\n" $((DBOX_W-4)) "$L"
done <<< "$WRAPPED_FLAVOR_LINE"
printf "${BOX_COLOR}╚"; printf '═%.0s' $(seq 1 $((DBOX_W-2))); printf "╝\n${RESET_COLOR}\n"
